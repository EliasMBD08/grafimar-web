networks:
  traefik-network:
    external: true

services:
  web-grafimar:
    build:
      context: .
      dockerfile: Dockerfile
    image: web-grafimar
    container_name: web-grafimar
    restart: always
    labels:
      - traefik.enable=true
      - traefik.docker.network=traefik-network

      # HTTP (redirecci√≥n a HTTPS)
      - traefik.http.routers.web-grafimar-http.rule=Host(`cgrafimar.com`) || Host(`www.cgrafimar.com`)
      - traefik.http.routers.web-grafimar-http.entrypoints=web
      - traefik.http.routers.web-grafimar-http.middlewares=redirect-to-https

      # HTTPS
      - traefik.http.routers.web-grafimar.rule=Host(`cgrafimar.com`) || Host(`www.cgrafimar.com`)
      - traefik.http.routers.web-grafimar.entrypoints=websecure
      - traefik.http.routers.web-grafimar.tls=true
      - traefik.http.routers.web-grafimar.tls.certresolver=letsencrypt

      # Puerto interno del contenedor
      - traefik.http.services.web-grafimar.loadbalancer.server.port=80
    networks:
      - traefik-network
